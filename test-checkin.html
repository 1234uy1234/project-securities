<!DOCTYPE html>
<html>
<head>
    <title>Test Check-in v·ªõi ·∫£nh</title>
</head>
<body>
    <h1>Test Check-in v·ªõi ·∫£nh</h1>
    <input type="file" id="photoInput" accept="image/*">
    <button onclick="testCheckin()">Test Check-in</button>
    <div id="result"></div>

    <script>
        async function testCheckin() {
            const result = document.getElementById('result');
            const photoInput = document.getElementById('photoInput');
            
            if (!photoInput.files[0]) {
                result.innerHTML = '‚ùå Vui l√≤ng ch·ªçn ·∫£nh!';
                return;
            }
            
            result.innerHTML = 'ƒêang test...';
            
            try {
                const formData = new FormData();
                formData.append('qr_data', 'test_frontend_fix');
                formData.append('photo', photoInput.files[0]);
                
                console.log('üì§ FormData entries:');
                for (let [key, value] of formData.entries()) {
                    console.log(`  ${key}:`, value);
                }
                
                const response = await fetch('https://10.10.68.72:8000/api/checkin/simple', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJodW5nIiwiZXhwIjoxNzU5MTM5ODQwfQ.8EvdfCt6L1H8CB6ddpyuplQ2xULZDCm-qRhqRBlBRYo'
                    },
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.photo_url) {
                    result.innerHTML = `‚úÖ Th√†nh c√¥ng!<br>
                        Photo URL: ${data.photo_url}<br>
                        Check-in time: ${data.check_in_time}<br>
                        Task: ${data.task_title}`;
                } else {
                    result.innerHTML = `‚ùå L·ªói: ${data.message || 'Kh√¥ng c√≥ photo_url'}`;
                }
                
            } catch (error) {
                result.innerHTML = `‚ùå L·ªói: ${error.message}`;
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>