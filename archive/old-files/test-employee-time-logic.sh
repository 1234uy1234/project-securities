#!/bin/bash

echo "🧪 TEST EMPLOYEE DASHBOARD TIME LOGIC"
echo "====================================="

echo ""
echo "📋 HƯỚNG DẪN TEST:"
echo "1. Mở Employee Dashboard trong browser"
echo "2. Mở Developer Console (F12)"
echo "3. Quan sát logs chi tiết về tính toán thời gian"
echo "4. Kiểm tra trạng thái thay đổi chính xác"
echo ""

echo "🔍 CÁC LOGS CẦN QUAN SÁT:"
echo "- 🕐 EMPLOYEE: Current time: [thời gian hiện tại]"
echo "- 🕐 EMPLOYEE: Stop [ID] scheduled_time: [thời gian được giao]"
echo "- 🕐 EMPLOYEE: Current date: [ngày hiện tại], Current time in minutes: [phút]"
echo "- 🕐 EMPLOYEE: Using stop.scheduled_time: [HH:MM] = [phút] minutes"
echo "- 🕐 EMPLOYEE: Task created_at: [timestamp], parsed date: [YYYY-MM-DD]"
echo "- 🕐 EMPLOYEE: Date comparison: {...}"
echo "- 🕐 EMPLOYEE: Time comparison: {...}"
echo ""

echo "🎯 LOGIC KIỂM TRA:"
echo "1. **Task hôm nay + chưa đến giờ**: Màu xám 'Chưa đến giờ'"
echo "2. **Task hôm nay + trong giờ**: Màu xanh dương 'Chờ chấm công'"
echo "3. **Task hôm nay + quá hạn**: Màu đỏ 'Quá hạn'"
echo "4. **Task hôm qua + chưa chấm**: Màu đỏ 'Quá hạn (chưa chấm công)'"
echo "5. **Task tương lai**: Màu xám 'Chưa đến ngày'"
echo "6. **Đã chấm công**: Màu xanh lá 'Đã chấm công'"
echo ""

echo "🚀 BẮT ĐẦU TEST:"
echo "1. cd frontend && npm run dev"
echo "2. Vào: http://localhost:5173/employee-dashboard"
echo "3. Đăng nhập với employee account"
echo "4. Mở F12 → Console tab"
echo "5. Quan sát logs chi tiết"
echo ""

echo "⏰ TIMELINE TEST:"
echo "- **Trước giờ chấm công**:"
echo "  - currentTimeInMinutes < scheduledTimeInMinutes"
echo "  - isToday = true, isOverdue = false"
echo "  - Kết quả: 'Chờ chấm công' (màu xanh dương)"
echo ""
echo "- **Sau giờ chấm công (quá 15 phút)**:"
echo "  - currentTimeInMinutes > scheduledTimeInMinutes + 15"
echo "  - isToday = true, isOverdue = true"
echo "  - Kết quả: 'Quá hạn' (màu đỏ)"
echo ""
echo "- **Task hôm qua chưa chấm**:"
echo "  - taskDate < currentDate"
echo "  - isPastTask = true"
echo "  - Kết quả: 'Quá hạn (chưa chấm công)' (màu đỏ)"
echo ""

echo "🔧 NẾU VẪN BÁO 'CHƯA ĐẾN GIỜ' KHI ĐÃ QUÁ HẠN:"
echo "1. Kiểm tra logs:"
echo "   - scheduledTimeInMinutes có đúng không?"
echo "   - currentTimeInMinutes có đúng không?"
echo "   - timeDiff có dương không?"
echo "   - isOverdue có true không?"
echo ""
echo "2. Kiểm tra dữ liệu:"
echo "   - stop.scheduled_time có đúng format HH:MM không?"
echo "   - task.created_at có đúng ngày không?"
echo "   - timezone có đúng Asia/Ho_Chi_Minh không?"
echo ""
echo "3. Debug thêm:"
echo "   - Thêm console.log trong từng điều kiện if"
echo "   - Kiểm tra task.schedule_week có đúng JSON không?"
echo "   - Kiểm tra stop.sequence có đúng không?"
echo ""

echo "✅ TEST HOÀN THÀNH!"
