#!/bin/bash

echo "ğŸ§ª TEST PHOTO DISPLAY FIX"
echo "========================="

echo ""
echo "ğŸ“‹ Váº¤N Äá»€ ÄÃƒ TÃŒM THáº¤Y:"
echo "1. Database cÃ³ field 'photo_path' nhÆ°ng frontend tÃ¬m 'photo_url'"
echo "2. Backend Ä‘Ã£ sá»­a mapping: photo_path â†’ photo_url"
echo "3. áº¢nh tá»“n táº¡i trÃªn server vÃ  cÃ³ thá»ƒ truy cáº­p qua HTTP"
echo "4. Frontend Ä‘ang sá»­ dá»¥ng ngrok URL thay vÃ¬ localhost"
echo ""

echo "ğŸ” KIá»‚M TRA BACKEND MAPPING:"
echo "âœ… photo_path: uploads/checkin_12_20251008_082554.jpg"
echo "âœ… mapped photo_url: /uploads/checkin_12_20251008_082554.jpg"
echo "âœ… áº¢nh tá»“n táº¡i: backend/uploads/checkin_12_20251008_082554.jpg"
echo "âœ… HTTP access: http://localhost:8000/uploads/checkin_12_20251008_082554.jpg (200 OK)"
echo ""

echo "ğŸ¯ CÃCH TEST:"
echo "1. Má»Ÿ Employee Dashboard"
echo "2. Má»Ÿ F12 â†’ Console"
echo "3. Kiá»ƒm tra logs:"
echo "   - ğŸ” DEBUG: Record [ID] photo_url: [path]"
echo "   - âœ… Image loaded: [path]"
echo "   - âŒ Image failed to load: [path]"
echo ""

echo "ğŸ”§ Náº¾U VáºªN KHÃ”NG HIá»‚N THá»Š áº¢NH:"
echo "1. Kiá»ƒm tra URL áº£nh trong console:"
echo "   - URL pháº£i lÃ : https://semiprivate-interlamellar-phillis.ngrok-free.dev/uploads/..."
echo "   - KhÃ´ng Ä‘Æ°á»£c lÃ : https://localhost:8000/uploads/..."
echo ""
echo "2. Kiá»ƒm tra network tab:"
echo "   - Request Ä‘áº¿n /uploads/... pháº£i tráº£ vá» 200 OK"
echo "   - Náº¿u 404: backend khÃ´ng serve áº£nh Ä‘Ãºng"
echo "   - Náº¿u CORS error: cáº¥u hÃ¬nh CORS sai"
echo ""
echo "3. Kiá»ƒm tra backend logs:"
echo "   - Photo mapping logic Ä‘Ã£ cháº¡y"
echo "   - API tráº£ vá» photo_url Ä‘Ãºng"
echo ""

echo "ğŸš€ Báº®T Äáº¦U TEST:"
echo "1. cd frontend && npm run dev"
echo "2. VÃ o: http://localhost:5173/employee-dashboard"
echo "3. ÄÄƒng nháº­p vá»›i employee account"
echo "4. Má»Ÿ F12 â†’ Console tab"
echo "5. Quan sÃ¡t logs áº£nh"
echo ""

echo "ğŸ“± KIá»‚M TRA CÃC TRANG:"
echo "1. **Employee Dashboard**:"
echo "   - FlowStep cÃ³ hiá»ƒn thá»‹ áº£nh thumbnail khÃ´ng?"
echo "   - Click vÃ o stop point cÃ³ hiá»ƒn thá»‹ áº£nh trong modal khÃ´ng?"
echo ""
echo "2. **Reports Page**:"
echo "   - Báº£ng report cÃ³ hiá»ƒn thá»‹ áº£nh thumbnail khÃ´ng?"
echo "   - Click 'Xem áº£nh' cÃ³ má»Ÿ áº£nh lá»›n khÃ´ng?"
echo ""
echo "3. **Admin Dashboard**:"
echo "   - FlowStep cÃ³ hiá»ƒn thá»‹ áº£nh thumbnail khÃ´ng?"
echo "   - Click vÃ o stop point cÃ³ hiá»ƒn thá»‹ áº£nh trong modal khÃ´ng?"
echo ""

echo "âœ… Káº¾T QUáº¢ MONG Äá»¢I:"
echo "- âœ… áº¢nh hiá»ƒn thá»‹ thumbnail trong FlowStep"
echo "- âœ… áº¢nh hiá»ƒn thá»‹ trong modal khi click"
echo "- âœ… áº¢nh hiá»ƒn thá»‹ trong báº£ng report"
echo "- âœ… Console khÃ´ng cÃ³ lá»—i áº£nh"
echo ""

echo "ğŸ”§ Náº¾U VáºªN CÃ“ Váº¤N Äá»€:"
echo "1. Restart backend:"
echo "   cd backend && python -m uvicorn app.main:app --reload"
echo ""
echo "2. Kiá»ƒm tra ngrok:"
echo "   ngrok http 8000"
echo ""
echo "3. Cáº­p nháº­t config.ts vá»›i URL má»›i"
echo ""

echo "âœ… TEST HOÃ€N THÃ€NH!"
