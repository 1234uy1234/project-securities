#!/bin/bash

echo "ğŸ”§ TEST CAMERA SELFIE FIX"
echo "=========================="

# Kiá»ƒm tra frontend Ä‘ang cháº¡y
echo "ğŸ“± Kiá»ƒm tra frontend..."
if curl -s -k https://10.10.68.200:5173 > /dev/null; then
    echo "âœ… Frontend Ä‘ang cháº¡y trÃªn https://10.10.68.200:5173"
else
    echo "âŒ Frontend khÃ´ng cháº¡y. Vui lÃ²ng khá»Ÿi Ä‘á»™ng frontend trÆ°á»›c."
    exit 1
fi

# Kiá»ƒm tra backend Ä‘ang cháº¡y
echo "ğŸ”§ Kiá»ƒm tra backend..."
if curl -s -k https://10.10.68.200:8000/health > /dev/null; then
    echo "âœ… Backend Ä‘ang cháº¡y trÃªn https://10.10.68.200:8000"
else
    echo "âŒ Backend khÃ´ng cháº¡y. Vui lÃ²ng khá»Ÿi Ä‘á»™ng backend trÆ°á»›c."
    exit 1
fi

echo ""
echo "ğŸ¯ HÆ¯á»šNG DáºªN TEST CAMERA SELFIE:"
echo "================================"
echo ""
echo "1. ğŸ“± Má»Ÿ trÃ¬nh duyá»‡t vÃ  truy cáº­p:"
echo "   https://10.10.68.200:5173"
echo ""
echo "2. ğŸ” ÄÄƒng nháº­p vá»›i tÃ i khoáº£n admin"
echo ""
echo "3. ğŸ“· VÃ o trang QR Scanner:"
echo "   https://10.10.68.200:5173/qr-scan"
echo ""
echo "4. ğŸ¯ Test camera selfie:"
echo "   - QuÃ©t QR code báº¥t ká»³"
echo "   - Báº¥m 'Báº­t Camera' trong pháº§n 'Chá»¥p áº£nh xÃ¡c nháº­n'"
echo "   - Thá»­ chuyá»ƒn Ä‘á»•i giá»¯a camera sau vÃ  camera selfie"
echo "   - Test chá»¥p áº£nh vá»›i camera selfie"
echo ""
echo "5. ğŸ§ª Test file HTML Ä‘á»™c láº­p:"
echo "   Má»Ÿ file: test_camera_selfie.html trong trÃ¬nh duyá»‡t"
echo ""
echo "ğŸ” CÃC Lá»–I THÆ¯á»œNG Gáº¶P VÃ€ CÃCH Sá»¬A:"
echo "=================================="
echo ""
echo "âŒ 'Camera selfie bá»‹ tá»« chá»‘i'"
echo "   â†’ Cho phÃ©p camera trong trÃ¬nh duyá»‡t"
echo "   â†’ Kiá»ƒm tra cÃ i Ä‘áº·t quyá»n camera"
echo ""
echo "âŒ 'KhÃ´ng tÃ¬m tháº¥y camera selfie'"
echo "   â†’ Kiá»ƒm tra thiáº¿t bá»‹ cÃ³ camera trÆ°á»›c khÃ´ng"
echo "   â†’ Thá»­ trÃªn thiáº¿t bá»‹ khÃ¡c"
echo ""
echo "âŒ 'Camera selfie Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng'"
echo "   â†’ ÄÃ³ng cÃ¡c á»©ng dá»¥ng khÃ¡c Ä‘ang dÃ¹ng camera"
echo "   â†’ Restart trÃ¬nh duyá»‡t"
echo ""
echo "âŒ 'Camera selfie timeout'"
echo "   â†’ Kiá»ƒm tra káº¿t ná»‘i máº¡ng"
echo "   â†’ Thá»­ láº¡i sau vÃ i giÃ¢y"
echo ""
echo "âœ… Cáº¢I TIáº¾N ÄÃƒ THá»°C HIá»†N:"
echo "========================"
echo ""
echo "1. ğŸ”§ TÄƒng timeout tá»« 3s â†’ 5s cho camera selfie"
echo "2. ğŸ›¡ï¸ ThÃªm fallback constraints Ä‘Æ¡n giáº£n hÆ¡n"
echo "3. â±ï¸ ThÃªm delay 300ms giá»¯a cÃ¡c láº§n khá»Ÿi Ä‘á»™ng camera"
echo "4. ğŸ“ Cáº£i thiá»‡n thÃ´ng bÃ¡o lá»—i cá»¥ thá»ƒ cho camera selfie"
echo "5. ğŸ”„ ThÃªm nÃºt 'Äá»•i Camera' khi gáº·p lá»—i"
echo "6. ğŸ¯ ThÃªm constraints tá»‘i Æ°u cho mobile"
echo ""
echo "ğŸš€ Báº®T Äáº¦U TEST..."
echo "=================="
echo ""
echo "Má»Ÿ trÃ¬nh duyá»‡t vÃ  test theo hÆ°á»›ng dáº«n trÃªn!"
echo ""
echo "ğŸ“ Náº¿u váº«n gáº·p lá»—i, hÃ£y:"
echo "   1. Kiá»ƒm tra console log trong DevTools"
echo "   2. Thá»­ trÃªn thiáº¿t bá»‹ khÃ¡c"
echo "   3. Kiá»ƒm tra quyá»n camera trong trÃ¬nh duyá»‡t"
echo ""
